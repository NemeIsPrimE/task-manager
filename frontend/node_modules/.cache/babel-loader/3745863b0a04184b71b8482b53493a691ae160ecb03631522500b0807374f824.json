{"ast":null,"code":"import React,{createContext,useContext,useState,useEffect}from'react';import api,{authAPI}from'../services/api';import{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext();export const useAuth=()=>useContext(AuthContext);export function AuthProvider(_ref){let{children}=_ref;const[isAuthenticated,setIsAuthenticated]=useState(false);const[user,setUser]=useState(null);const[loading,setLoading]=useState(true);useEffect(()=>{const token=localStorage.getItem('token');if(token){api.defaults.headers.common['Authorization']=\"Bearer \".concat(token);authAPI.me().then(res=>{setUser(res.data.user);setIsAuthenticated(true);}).catch(()=>{localStorage.removeItem('token');}).finally(()=>setLoading(false));}else{setLoading(false);}},[]);const login=async(email,password)=>{const res=await authAPI.login(email,password);if(res.data.token){localStorage.setItem('token',res.data.token);api.defaults.headers.common['Authorization']=\"Bearer \".concat(res.data.token);setUser(res.data.user);setIsAuthenticated(true);}return res;};const register=async(username,email,password)=>{const res=await authAPI.register(username,email,password);if(res.data.token){localStorage.setItem('token',res.data.token);api.defaults.headers.common['Authorization']=\"Bearer \".concat(res.data.token);setUser(res.data.user);setIsAuthenticated(true);}return res;};const logout=()=>{localStorage.removeItem('token');delete api.defaults.headers.common['Authorization'];setIsAuthenticated(false);setUser(null);};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{isAuthenticated,user,login,register,logout,loading},children:children});}","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","api","authAPI","jsx","_jsx","AuthContext","useAuth","AuthProvider","_ref","children","isAuthenticated","setIsAuthenticated","user","setUser","loading","setLoading","token","localStorage","getItem","defaults","headers","common","concat","me","then","res","data","catch","removeItem","finally","login","email","password","setItem","register","username","logout","Provider","value"],"sources":["D:/task_manager/frontend/src/contexts/AuthContext.js"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect } from 'react';\nimport api, { authAPI } from '../services/api';\n\nconst AuthContext = createContext();\nexport const useAuth = () => useContext(AuthContext);\n\nexport function AuthProvider({ children }) {\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n    if (token) {\n      api.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n      authAPI.me()\n        .then(res => {\n          setUser(res.data.user);\n          setIsAuthenticated(true);\n        })\n        .catch(() => {\n          localStorage.removeItem('token');\n        })\n        .finally(() => setLoading(false));\n    } else {\n      setLoading(false);\n    }\n  }, []);\n\n  const login = async (email, password) => {\n    const res = await authAPI.login(email, password);\n    if (res.data.token) {\n      localStorage.setItem('token', res.data.token);\n      api.defaults.headers.common['Authorization'] = `Bearer ${res.data.token}`;\n      setUser(res.data.user);\n      setIsAuthenticated(true);\n    }\n    return res;\n  };\n\n  const register = async (username, email, password) => {\n    const res = await authAPI.register(username, email, password);\n    if (res.data.token) {\n      localStorage.setItem('token', res.data.token);\n      api.defaults.headers.common['Authorization'] = `Bearer ${res.data.token}`;\n      setUser(res.data.user);\n      setIsAuthenticated(true);\n    }\n    return res;\n  };\n\n  const logout = () => {\n    localStorage.removeItem('token');\n    delete api.defaults.headers.common['Authorization'];\n    setIsAuthenticated(false);\n    setUser(null);\n  };\n\n  return (\n    <AuthContext.Provider value={{ isAuthenticated, user, login, register, logout, loading }}>\n      {children}\n    </AuthContext.Provider>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}